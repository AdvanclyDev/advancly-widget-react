{"version":3,"file":"advancly-widget-react.cjs.development.js","sources":["../src/types/index.tsx","../src/AdvanclyWidget.tsx"],"sourcesContent":["export enum RESPONSE_STATUSES {\n  SUCCESS = \"success\",\n  CANCEL = \"cancel\",\n}\n\nexport enum ENVIRONMENT {\n  TEST = \"test\",\n  STAGING = \"staging\",\n  PRODUCTION = \"production\",\n}\n\nexport interface IResponse {\n  status: RESPONSE_STATUSES;\n  data: {\n    message?: string;\n    loan_amount?: string;\n    loan_application_referenceno?: string;\n    loan_interest?: string;\n    loan_product?: string;\n    loan_tenure?: string;\n  };\n}\n\nexport interface AdvanclyProps {\n  aggregator_id: number; // The ID of the aggregator / business giving out the loan\n  bank_account_number: string | number; // The borrower's bank account number\n  bank_code: string | number; // The borrower's bank code on Advancly\n  borrower_phone: string; // The borrower's phone number\n  bvn_number: string; // The borrower's BVN number\n  aggregator_loan_ref?: string; // The loan reference number on your platform Not required\n  cac_number?: string; // For corporate borrowers, provide the CAC number\n  city: string; // City of the borrower\n  company_name?: string; // For corporate borrowers, provide the company name\n  customer_type: \"1\" | \"2\"; // 1 for individual, 2 for corporate\n  email: string; // The borrower's email address\n  first_name: string; // The borrower's first name\n  gender: string; // The borrower's gender\n  last_name: string; // The borrower's last name\n  photo_url?: string; // The photo url of the borrower\n  public_key: string; // Your public key. Sign up on https://aggregator.advancly.com to get yours.\n  residence_address: string; // The borrower's address\n  state: string; // The state of the borrower\n  product_id: number; // The product ID of the loan. This can be gotten on the aggregator's platform\n  product_code: string; // The product code of the loan. This can be gotten on the aggregator's platform\n  tenure: number; // The loan tenure in days\n  customStyles?: {\n    buttonBackgroundColor?: string; // Can be string or the color code\n    buttonTextColor?: string; // Can be string or the color code\n    acceptButtonBackgroundColor?: string; // Can be string or the color code\n    acceptButtonTextColor?: string; // Can be string or the color code\n    declineButtonBackgroundColor?: string; // Can be string or the color code\n    declineButtonTextColor?: string; // Can be string or the color code\n    dropdownTextColor?: string; // Can be string or the color code\n    dropdownBackgroundColor?: string; // Can be string or the color code\n  };\n  onCancel: (response: IResponse) => void; // Handle the cancel event from the widget\n  onSuccess: (response: IResponse) => void; // Handle the success event from the widget\n  autoStart?: boolean; // Defaults to false. If set to true, the widget will automatically start\n  showWidget: boolean; // Defaults to false. If set to true, the widget will come up\n  environment: ENVIRONMENT; // Defaults to test. Can be set to \"staging\" or \"production\"\n}\n","import React, { useCallback } from \"react\";\nimport { useEffect } from \"react\";\nimport {\n  AdvanclyProps,\n  IResponse,\n  RESPONSE_STATUSES,\n  ENVIRONMENT,\n} from \"./types\";\n\nconst AdvanclyWidget: React.ForwardRefRenderFunction<\n  React.ReactNode,\n  AdvanclyProps\n> = ({\n  aggregator_id,\n  bank_account_number,\n  bank_code,\n  borrower_phone,\n  bvn_number,\n  aggregator_loan_ref = `${Date.now().toString()}`,\n  cac_number,\n  city,\n  company_name,\n  customer_type,\n  email,\n  first_name,\n  gender,\n  last_name,\n  photo_url,\n  public_key,\n  residence_address,\n  state,\n  product_id,\n  product_code,\n  tenure,\n  customStyles,\n  onSuccess,\n  onCancel,\n  showWidget,\n  autoStart = false,\n  environment = ENVIRONMENT.TEST,\n}) => {\n  const msgToPost = {\n    aggregator_id,\n    bank_account_number,\n    bank_code,\n    borrower_phone,\n    bvn_number,\n    aggregator_loan_ref,\n    cac_number,\n    city,\n    company_name,\n    customer_type,\n    email,\n    first_name,\n    gender,\n    last_name,\n    photo_url,\n    public_key,\n    residence_address,\n    state,\n    product_id,\n    product_code,\n    tenure,\n    customStyles,\n  };\n\n  const BASE_URL = () => {\n    switch (environment) {\n      case ENVIRONMENT.TEST:\n        return \"https://advancly-borrower.test.vggdev.com/create-loan-account/\";\n      case ENVIRONMENT.STAGING:\n        return \"https://advancly-borrower.staging.vggdev.com/create-loan-account/\";\n      case ENVIRONMENT.PRODUCTION:\n        return \"https://borrower.advancly.com/create-loan-account/\";\n      default:\n        return \"https://advancly-borrower.test.vggdev.com/create-loan-account/\";\n    }\n  };\n\n  const advanclyWidget = useCallback(() => {\n    const openWidget = () => {\n      var style = document.createElement(\"style\");\n      style.innerHTML = ` \n        body {\n        margin: 0;\n      }\n      .advancly {\n        border: none;\n        height: 100vh;\n        width: 100vw;\n        position: fixed;\n        left: 0;\n        top: 0;\n        overflow: hidden;\n      }`;\n      let iframeContainer = document.createElement(\"div\");\n      iframeContainer.setAttribute(\"class\", \"advancly-widget\");\n      let iframe = document.createElement(\"iframe\");\n      iframe.setAttribute(\"class\", \"advancly\");\n      iframe.src = BASE_URL();\n\n      const closeWidget = () => iframeContainer.remove();\n\n      window.addEventListener(\"message\", function (e) {\n        messageReceived(e?.data);\n        closeWidget();\n      });\n\n      iframeContainer.appendChild(iframe);\n      document.head.appendChild(style);\n      document.body.appendChild(iframeContainer);\n\n      iframe.onload = () =>\n        iframe.contentWindow?.postMessage(msgToPost, BASE_URL());\n    };\n\n    openWidget();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const messageReceived = (data: IResponse) => {\n    switch (data.status) {\n      case RESPONSE_STATUSES.SUCCESS:\n        if (onSuccess) {\n          onSuccess({\n            status: RESPONSE_STATUSES.SUCCESS,\n            data: data?.data,\n          });\n        }\n        break;\n\n      case RESPONSE_STATUSES.CANCEL:\n        if (onCancel) {\n          onCancel({\n            status: RESPONSE_STATUSES.CANCEL,\n            data: data?.data,\n          });\n        }\n        break;\n\n      default:\n        break;\n    }\n  };\n\n  useEffect(() => {\n    if (autoStart) {\n      setTimeout(() => {\n        advanclyWidget();\n      }, 500);\n    }\n  }, [advanclyWidget, autoStart]);\n\n  useEffect(() => {\n    showWidget && advanclyWidget();\n  }, [advanclyWidget, showWidget]);\n\n  return null;\n};\n\nexport default AdvanclyWidget;\n"],"names":["RESPONSE_STATUSES","ENVIRONMENT","AdvanclyWidget","aggregator_id","bank_account_number","bank_code","borrower_phone","bvn_number","aggregator_loan_ref","Date","now","toString","cac_number","city","company_name","customer_type","email","first_name","gender","last_name","photo_url","public_key","residence_address","state","product_id","product_code","tenure","customStyles","onSuccess","onCancel","showWidget","autoStart","environment","TEST","msgToPost","BASE_URL","STAGING","PRODUCTION","advanclyWidget","useCallback","openWidget","style","document","createElement","innerHTML","iframeContainer","setAttribute","iframe","src","closeWidget","remove","window","addEventListener","e","messageReceived","data","appendChild","head","body","onload","contentWindow","postMessage","status","SUCCESS","CANCEL","useEffect","setTimeout"],"mappings":"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"}