{"version":3,"file":"advancly-widget-react.cjs.production.min.js","sources":["../src/types/index.tsx","../src/AdvanclyWidget.tsx"],"sourcesContent":["export enum RESPONSE_STATUSES {\n  SUCCESS = \"success\",\n  CANCEL = \"cancel\",\n}\n\nexport enum ENVIRONMENT {\n  TEST = \"test\",\n  STAGING = \"staging\",\n  PRODUCTION = \"production\",\n}\n\nexport interface IResponse {\n  status: RESPONSE_STATUSES;\n  data: {\n    message?: string;\n    loan_amount?: string;\n    loan_application_referenceno?: string;\n    loan_interest?: string;\n    loan_product?: string;\n    loan_tenure?: string;\n  };\n}\n\nexport interface AdvanclyProps {\n  aggregator_id: number; // The ID of the aggregator / business giving out the loan\n  bank_account_number: string | number; // The borrower's bank account number\n  bank_code: string | number; // The borrower's bank code on Advancly\n  borrower_phone: string; // The borrower's phone number\n  bvn_number: string; // The borrower's BVN number\n  aggregator_loan_ref?: string; // The loan reference number on your platform Not required\n  cac_number?: string; // For corporate borrowers, provide the CAC number\n  city: string; // City of the borrower\n  company_name?: string; // For corporate borrowers, provide the company name\n  customer_type: \"1\" | \"2\"; // 1 for individual, 2 for corporate\n  email: string; // The borrower's email address\n  first_name: string; // The borrower's first name\n  gender: string; // The borrower's gender\n  last_name: string; // The borrower's last name\n  photo_url?: string; // The photo url of the borrower\n  public_key: string; // Your public key. Sign up on https://aggregator.advancly.com to get yours.\n  residence_address: string; // The borrower's address\n  state: string; // The state of the borrower\n  product_id: number; // The product ID of the loan. This can be gotten on the aggregator's platform\n  product_code: string; // The product code of the loan. This can be gotten on the aggregator's platform\n  tenure: number; // The loan tenure in days\n  customStyles?: {\n    buttonBackgroundColor?: string; // Can be string or the color code\n    buttonTextColor?: string; // Can be string or the color code\n    acceptButtonBackgroundColor?: string; // Can be string or the color code\n    acceptButtonTextColor?: string; // Can be string or the color code\n    declineButtonBackgroundColor?: string; // Can be string or the color code\n    declineButtonTextColor?: string; // Can be string or the color code\n    dropdownTextColor?: string; // Can be string or the color code\n    dropdownBackgroundColor?: string; // Can be string or the color code\n  };\n  onCancel: (response: IResponse) => void; // Handle the cancel event from the widget\n  onSuccess: (response: IResponse) => void; // Handle the success event from the widget\n  autoStart?: boolean; // Defaults to false. If set to true, the widget will automatically start\n  showWidget: boolean; // Defaults to false. If set to true, the widget will come up\n  environment: ENVIRONMENT; // Defaults to test. Can be set to \"staging\" or \"production\"\n}\n","import React, { useCallback } from \"react\";\nimport { useEffect } from \"react\";\nimport {\n  AdvanclyProps,\n  IResponse,\n  RESPONSE_STATUSES,\n  ENVIRONMENT,\n} from \"./types\";\n\nconst AdvanclyWidget: React.ForwardRefRenderFunction<\n  React.ReactNode,\n  AdvanclyProps\n> = ({\n  aggregator_id,\n  bank_account_number,\n  bank_code,\n  borrower_phone,\n  bvn_number,\n  aggregator_loan_ref = `${Date.now().toString()}`,\n  cac_number,\n  city,\n  company_name,\n  customer_type,\n  email,\n  first_name,\n  gender,\n  last_name,\n  photo_url,\n  public_key,\n  residence_address,\n  state,\n  product_id,\n  product_code,\n  tenure,\n  customStyles,\n  onSuccess,\n  onCancel,\n  showWidget,\n  autoStart = false,\n  environment = ENVIRONMENT.TEST,\n}) => {\n  const msgToPost = {\n    aggregator_id,\n    bank_account_number,\n    bank_code,\n    borrower_phone,\n    bvn_number,\n    aggregator_loan_ref,\n    cac_number,\n    city,\n    company_name,\n    customer_type,\n    email,\n    first_name,\n    gender,\n    last_name,\n    photo_url,\n    public_key,\n    residence_address,\n    state,\n    product_id,\n    product_code,\n    tenure,\n    customStyles,\n  };\n\n  const BASE_URL = () => {\n    switch (environment) {\n      case ENVIRONMENT.TEST:\n        return \"https://advancly-borrower.test.vggdev.com/create-loan-account/\";\n      case ENVIRONMENT.STAGING:\n        return \"https://advancly-borrower.staging.vggdev.com/create-loan-account/\";\n      case ENVIRONMENT.PRODUCTION:\n        return \"https://borrower.advancly.com/create-loan-account/\";\n      default:\n        return \"https://advancly-borrower.test.vggdev.com/create-loan-account/\";\n    }\n  };\n\n  const advanclyWidget = useCallback(() => {\n    const openWidget = () => {\n      var style = document.createElement(\"style\");\n      style.innerHTML = ` \n        body {\n        margin: 0;\n      }\n      .advancly {\n        border: none;\n        height: 100vh;\n        width: 100vw;\n        position: fixed;\n        left: 0;\n        top: 0;\n        overflow: hidden;\n      }`;\n      let iframeContainer = document.createElement(\"div\");\n      iframeContainer.setAttribute(\"class\", \"advancly-widget\");\n      let iframe = document.createElement(\"iframe\");\n      iframe.setAttribute(\"class\", \"advancly\");\n      iframe.src = BASE_URL();\n\n      const closeWidget = () => iframeContainer.remove();\n\n      window.addEventListener(\"message\", function (e) {\n        messageReceived(e?.data);\n        closeWidget();\n      });\n\n      iframeContainer.appendChild(iframe);\n      document.head.appendChild(style);\n      document.body.appendChild(iframeContainer);\n\n      iframe.onload = () =>\n        iframe.contentWindow?.postMessage(msgToPost, BASE_URL());\n    };\n\n    openWidget();\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const messageReceived = (data: IResponse) => {\n    switch (data.status) {\n      case RESPONSE_STATUSES.SUCCESS:\n        if (onSuccess) {\n          onSuccess({\n            status: RESPONSE_STATUSES.SUCCESS,\n            data: data?.data,\n          });\n        }\n        break;\n\n      case RESPONSE_STATUSES.CANCEL:\n        if (onCancel) {\n          onCancel({\n            status: RESPONSE_STATUSES.CANCEL,\n            data: data?.data,\n          });\n        }\n        break;\n\n      default:\n        break;\n    }\n  };\n\n  useEffect(() => {\n    if (autoStart) {\n      setTimeout(() => {\n        advanclyWidget();\n      }, 500);\n    }\n  }, [advanclyWidget, autoStart]);\n\n  useEffect(() => {\n    showWidget && advanclyWidget();\n  }, [advanclyWidget, showWidget]);\n\n  return null;\n};\n\nexport default AdvanclyWidget;\n"],"names":["RESPONSE_STATUSES","ENVIRONMENT","AdvanclyWidget","aggregator_id","bank_account_number","bank_code","borrower_phone","bvn_number","aggregator_loan_ref","Date","now","toString","onSuccess","onCancel","showWidget","autoStart","environment","TEST","msgToPost","cac_number","city","company_name","customer_type","email","first_name","gender","last_name","photo_url","public_key","residence_address","state","product_id","product_code","tenure","customStyles","BASE_URL","STAGING","PRODUCTION","advanclyWidget","useCallback","style","document","createElement","innerHTML","iframeContainer","setAttribute","iframe","src","window","addEventListener","e","messageReceived","data","remove","appendChild","head","body","onload","contentWindow","_iframe$contentWindow","postMessage","openWidget","status","SUCCESS","CANCEL","useEffect","setTimeout"],"mappings":"wEAAYA,EAKAC,sBALZ,SAAYD,GACVA,oBACAA,kBAFF,CAAYA,IAAAA,OAKZ,SAAYC,GACVA,cACAA,oBACAA,0BAHF,CAAYA,IAAAA,4FCINC,EAGF,gBACFC,IAAAA,cACAC,IAAAA,oBACAC,IAAAA,UACAC,IAAAA,eACAC,IAAAA,eACAC,oBAAAA,gBAAyBC,KAAKC,MAAMC,aAiBpCC,IAAAA,UACAC,IAAAA,SACAC,IAAAA,eACAC,UAAAA,oBACAC,YAAAA,aAAcf,EAAYgB,OAEpBC,EAAY,CAChBf,cAAAA,EACAC,oBAAAA,EACAC,UAAAA,EACAC,eAAAA,EACAC,WAAAA,EACAC,oBAAAA,EACAW,aA7BFA,WA8BEC,OA7BFA,KA8BEC,eA7BFA,aA8BEC,gBA7BFA,cA8BEC,QA7BFA,MA8BEC,aA7BFA,WA8BEC,SA7BFA,OA8BEC,YA7BFA,UA8BEC,YA7BFA,UA8BEC,aA7BFA,WA8BEC,oBA7BFA,kBA8BEC,QA7BFA,MA8BEC,aA7BFA,WA8BEC,eA7BFA,aA8BEC,SA7BFA,OA8BEC,eA7BFA,cAgCMC,EAAW,kBACPnB,QACDf,EAAYgB,WACR,sEACJhB,EAAYmC,cACR,yEACJnC,EAAYoC,iBACR,mEAEA,mEAIPC,EAAiBC,eAAY,YACd,eACbC,EAAQC,SAASC,cAAc,SACnCF,EAAMG,yPAaFC,EAAkBH,SAASC,cAAc,OAC7CE,EAAgBC,aAAa,QAAS,uBAClCC,EAASL,SAASC,cAAc,UACpCI,EAAOD,aAAa,QAAS,YAC7BC,EAAOC,IAAMZ,IAIba,OAAOC,iBAAiB,WAAW,SAAUC,GAC3CC,QAAgBD,SAAAA,EAAGE,MAHKR,EAAgBS,YAO1CT,EAAgBU,YAAYR,GAC5BL,SAASc,KAAKD,YAAYd,GAC1BC,SAASe,KAAKF,YAAYV,GAE1BE,EAAOW,OAAS,iCACdX,EAAOY,sBAAPC,EAAsBC,YAAY1C,EAAWiB,MAGjD0B,KAEC,IAEGV,EAAkB,SAACC,UACfA,EAAKU,aACN9D,EAAkB+D,QACjBnD,GACFA,EAAU,CACRkD,OAAQ9D,EAAkB+D,QAC1BX,WAAMA,SAAAA,EAAMA,kBAKbpD,EAAkBgE,OACjBnD,GACFA,EAAS,CACPiD,OAAQ9D,EAAkBgE,OAC1BZ,WAAMA,SAAAA,EAAMA,gBAUtBa,aAAU,WACJlD,GACFmD,YAAW,WACT5B,MACC,OAEJ,CAACA,EAAgBvB,IAEpBkD,aAAU,WACRnD,GAAcwB,MACb,CAACA,EAAgBxB,IAEb"}